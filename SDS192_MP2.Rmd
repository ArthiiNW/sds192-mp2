---
title: "MiniProject2"
author: "Yingqi Zheng"
date: "10/23/2017"
output: html_document
---

```{r, message = FALSE}
load("house_elections.rda")
load("candidates.rda")
load("committees.rda")
load("contributions.rda")
```

Library packages
```{R, Message = FALSE}
library(ggplot2)
library(tidyverse)
```

```{R}
candyear <- candidates %>%
  select(-cand_office_district, -cand_status, -cand_city, -cand_state) %>%
  filter(cand_election_yr == 2012) %>%
  filter(cand_office == "S") 
```

```{r}
contritidy <- contributions %>%
  select(cmte_id, name, state, cand_id, transaction_amt)

contricand <-candyear %>%
  right_join(contritidy, by = "cand_id") %>%
  filter(cand_office == "S") %>%
  filter(!is.na(cand_name)) %>%
  arrange(cand_office_state)
```

```{R}
party <- contricand %>%
  group_by(cand_office_state, cand_party_affiliation) %>%
  mutate(partydonation = sum(transaction_amt)) %>%
summarise(nparty = sum(n())) %>%
spread(key = cand_party_affiliation, value = nparty)
```

```{R}
party[is.na(party)] <- 0

party2 <- party %>%
  mutate(total = DEM + REP + IND + LIB + SUS + GRE) %>%
  mutate (DEMtototal = DEM/total)
```

```{r}
candplot <- ggplot(data = party2, aes(x = cand_office_state, y = DEMtototal), alpha = 0.2) + 
  geom_point() +
  geom_hline(yintercept = 0.5) +  
  labs(title = "% Money Received by Democrat") +
  ylab(label = "Percentage") +
  xlab(label = "States") +
  theme(plot.title = element_text(hjust = 0.5))

candplot
```



